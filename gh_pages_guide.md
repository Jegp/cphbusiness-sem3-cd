# Continuous delivery with GitHub Pages

This guide briefly explains the idea of continuous delivery (CD) and gives a
step-by-step guide to build a website with NodeJS through Travis CI, pushing
the results to a website on GitHub (GitHub pages or gh-pages).

## Continuous delivery

Continuous delivery is very similar to continuous integration. The only
difference is that we have to tell our CI server (Travis-CI) to not
only build our code, but also deploy it! In this example we will be building
a small website with NodeJS and release it on GitHub pages. But continuous
delivery could be used for anything - for example Docker containers. Which is
particularly cool, because containers like that can be thrown around anywhere
without having to install or manage the server.

## The website
Instead of throwing some boring static HTML page up, which you would normally
do with GitHub pages, we would like to build our own website with NodeJS.
If you don't have NodeJS installed, don't waste your time on it now.
You only need to know that the website contains a lot of code that needs to
be bundled up somewhere. Just like you would bundle your Java code into a `.jar`
file. When we have done that, we want to take it and push it to the website.
But we're too lazy to do it manually, so we need to ask the build server to do
it for us.

## Setting up GitHub pages
Before we get started, we need to have somewhere to store the website.
For this exercise you should fork the following repository:
[https://github.com/Jegp/cphbusiness-sem3-cd](https://github.com/Jegp/cphbusiness-sem3-cd)

This is a simple Ember Javascript project which is being by NodeJS<sup>1</sup>.
When you execute the command `npm run build` it will take all the HTML, JavaScript and
CSS files and compress them together with all the images and other static files
so you have an optimized Web 2.0-ready homepage. Awesome, right? Now our
job is to throw that into Travis.

A note of warning: the project is deliberately big, so can take a while for
travis to build.

## Building your website with Travis-CI
The project comes with all the necessary code, including the (autogenerated) `.travis.yml` file.
The documentation for getting NodeJS packages to run on Travis can be found here: [https://docs.travis-ci.com/user/languages/javascript-with-nodejs/](https://docs.travis-ci.com/user/languages/javascript-with-nodejs/).

Just like with Maven, the default command in JavaScript is
to build and test the code (`npm test`). But that's actually not quite enough
for us. We also need to build it and bundle it up. That's done with the
`npm run build` command. So we need to add that line in the `script` section
of the `travis.yml` file. Put that line in the file now and push it to GitHub.
Did you get what you expected?

The last thing to do before Travis will start building is to activate CI for
the project, just like you did with the Maven CI project before.

## Deploying to a GitHub page
Before Travis-CI can push code to your GitHub page, we have to create an
access token for GitHub. When we give that token to Travis, Travis can prove
to GitHub that it's allowed to push to your page. There's a guide on how to
create a GitHub access token [here](https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/).

Finally, you have to set the environmental variable `GITHUB_TOKEN` to the
value of your GitHub access token. You can do that in the settings of the
project from Travis-CI. There's a guide to how you can do that
[here](https://docs.travis-ci.com/user/deployment/pages/#Setting-the-GitHub-token).

## Completing the guide
That was it. Really. Try to see if you can find your newly built website at
`https://<username>.github.io/cphbusiness-sem3-cd`.
Your project should now be continuously tested, built and
published every time you push to your repository. Neat, right? Remember that
you can do this for much more complicated stuff. It doesn't have to be websites.
It can be Docker containers, `.jar` files, Tomcat apps etc.

## Footnotes

1. [https://nodejs.org/en/](https://nodejs.org/en/)
